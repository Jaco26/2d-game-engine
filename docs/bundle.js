!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i,r,o,s,u,a=function(){function t(){this.listeners={},this.queue=[]}return t.prototype.on=function(t,e){this.listeners[t]&&this.off(t),this.listeners[t]=e},t.prototype.off=function(t){delete this.listeners[t]},t.prototype.emit=function(t,e){this.queue.unshift({event:t,payload:e})},t.prototype.flushQueue=function(t){for(;this.queue.length;){var e=this.queue.pop(),n=e.event,i=e.payload;"function"==typeof this.listeners[n]?this.listeners[n](t,i):console.warn("No listener registed for event: "+n)}},t}(),c=function(){function t(t){this.handle=null,this.callback=t}return t.prototype.play=function(){this.callback()?this.handle=requestAnimationFrame(this.play.bind(this)):this.pause()},t.prototype.pause=function(){cancelAnimationFrame(this.handle)},t.prototype.frame=function(){this.callback()},t}(),l=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((i=i.apply(t,e||[])).next())}))},f=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},h=function(){function t(){this.images={}}return t.prototype.computeFilenameFromPath=function(t){return t.slice(t.lastIndexOf("/")+1,t.lastIndexOf("."))},t.prototype.createImg=function(t){return new Promise((function(e,n){var i=new Image;i.src=t,i.onload=function(){e(i)}}))},t.prototype.load=function(t,e){return l(this,void 0,void 0,(function(){var n,i;return f(this,(function(r){switch(r.label){case 0:return n=e||this.computeFilenameFromPath(t),[4,this.createImg(t)];case 1:return i=r.sent(),this.images[n]=i,[2]}}))}))},t.prototype.loadBatch=function(t){var e=this;return Promise.all(t.map((function(t){var n=t[0],i=t[1];return e.load(n,i)})))},t.prototype.get=function(t){return this.images[t]},t}(),p=function(){function t(t){this.ctx=t}return t.prototype.fillStyle=function(t){return this.ctx.fillStyle=t,this},t.prototype.strokeStyle=function(t){return this.ctx.strokeStyle=t,this},t.prototype.fill=function(t){return t&&(this.ctx.fillStyle=t),this.ctx.fill(),this},t.prototype.stroke=function(t){return t&&(this.ctx.strokeStyle=t),this.ctx.stroke(),this},t.prototype.rect=function(t,e,n,i){return this.ctx.beginPath(),this.ctx.rect(t,e,n,i),this.ctx.closePath(),this},t.prototype.arc=function(t,e,n){return this.ctx.beginPath(),this.ctx.arc(t,e,n,0,2*Math.PI),this.ctx.closePath(),this},t.prototype.fillText=function(t,e,n,i,r){return this.ctx.beginPath(),this.ctx.font=i,this.ctx.fillText(n,t,e,r),this.ctx.closePath(),this},t.prototype.drawImage=function(t,e,n){return this.ctx.beginPath(),this.ctx.drawImage(t,e,n),this.ctx.closePath(),this},t.prototype.clearRect=function(t,e,n,i){return this.ctx.clearRect(t,e,n,i),this},t}(),d=function(){function t(){this.pressedKeys=[]}return t.prototype.listen=function(){var t=this;window.addEventListener("keydown",(function(e){return t.pushKeys(e)})),window.addEventListener("keyup",(function(e){return t.spliceKeys(e)}))},t.prototype.stopListening=function(){var t=this;window.removeEventListener("keydown",(function(e){return t.pushKeys(e)})),window.removeEventListener("keyup",(function(e){return t.spliceKeys(e)}))},t.prototype.pushKeys=function(t){this.pressedKeys.includes(t.key)||this.pressedKeys.push(t.key)},t.prototype.spliceKeys=function(t){this.pressedKeys.includes(t.key)&&this.pressedKeys.splice(this.pressedKeys.indexOf(t.key),1)},t}(),y=function(){function t(){this.messages=[]}return t.prototype.send=function(t){this.messages.push(t)},t.prototype.clear=function(){this.messages=[]},t}(),w={rect:function(t,e){return t.x+t.w>=e.x&&t.x<=e.x+e.w&&t.y+t.h>=e.y&&t.y<=e.y+e.h},circle:function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(Math.pow(n,2)+Math.pow(i,2))<=t.r+e.r},rectCircle:function(t,e){var n=e.x,i=e.y;e.x<t.x?n=t.x:e.x>=t.x+t.w&&(n=t.x+t.w),e.y<t.y?i=t.y:e.y>=t.y+t.h&&(i=t.y+t.h);var r=e.x-n,o=e.y-i;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))<=e.r}},b=function(){function t(){this.staticObjects=[],this.sprites=[],this.spriteIdIndexTable={},this.collision=w}return t.prototype.addSprite=function(t){this.sprites.push(t),this.spriteIdIndexTable[t.id]=this.sprites.length-1},t.prototype.getSprite=function(t){return this.sprites[this.spriteIdIndexTable[t]]},t.prototype.addStaticObject=function(t){this.staticObjects.push(t)},t.prototype.update=function(t,e){this.didObjectsCollide(t),this.sprites.forEach((function(n){n.handleInput("messages",t.messages),n.handleInput("keyboard",e),n.update()}))},t.prototype.didObjectsCollide=function(t){for(var e={},n=0;n<this.sprites.length;n++){var i=this.sprites[n];e[i.id]||(e[i.id]={});for(var r=0;r<this.sprites.length;r++){var o=this.sprites[r];e[o.id]||(e[o.id]={}),n===r||e[i.id][o.id]||e[o.id][i.id]||(this.collision.rect(i.dimensions,o.dimensions)&&t.send("SPRITE_COLLISION:"+i.id+","+o.id),e[i.id][o.id]=!0)}for(r=0;r<this.staticObjects.length;r++){var s=this.staticObjects[r];e[i.id][s.id]||(this.collision.rect(i.dimensions,s.dimensions)&&t.send("SPRITE_STATIC_OBJECT_COLLISION:"+i.id+","+s.id),e[i.id][s.id]=!0)}}},t}(),v=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((i=i.apply(t,e||[])).next())}))},x=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},m=function(){function t(t){var e=this,n=t.canvasId,i=t.universe,r=t.viewport,o=t.scene;this.state={ready:!1,gameOn:!1},this.events=new a,this.loader=new h,this.keyboard=new d,this.physics=new b,this.messages=new y,this.canvas=document.getElementById(n),this.canvasCtx=this.canvas.getContext("2d"),this.width=i.width,this.height=i.height,this.canvas.width=r.width,this.canvas.height=r.height,this.scene=o,this.viewport=r,this.brush=new p(this.canvasCtx),this.animation=new c((function(){return e.scene.update(e.ctx),e.events.flushQueue(e.ctx),e.messages.clear(),e.state.gameOn}))}return t.prototype.init=function(){return v(this,void 0,void 0,(function(){return x(this,(function(t){switch(t.label){case 0:return[4,this.scene.preload(this.ctx)];case 1:return t.sent(),this.scene.create(this.ctx),this.keyboard.listen(),this.state.ready=!0,[2]}}))}))},Object.defineProperty(t.prototype,"ctx",{get:function(){return{events:this.events,animation:this.animation,brush:this.brush,camera:1,physics:this.physics,loader:this.loader,viewport:this.viewport,pressedKeys:this.keyboard.pressedKeys,messages:this.messages}},enumerable:!1,configurable:!0}),t.prototype.frame=function(){this.animation.frame()},t.prototype.play=function(){this.state.gameOn=!0,this.animation.play()},t.prototype.pause=function(){this.state.gameOn=!1,this.animation.pause()},t.prototype.reset=function(){this.pause(),this.scene.create(this.ctx)},t.prototype.on=function(t,e){this.events.on(t,e)},t.prototype.off=function(t){this.events.off(t)},t}(),g=function(t){this.id=function(t){void 0===t&&(t=8);for(var e="0123456789abcdef",n=[],i=0;i<t;i++)n.push(e[Math.floor(Math.random()*e.length)]);return n.join("")}(),this.dimensions=t},O=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),I=function(t){function e(e){var n=t.call(this,e)||this;return n.states=[],n.dx=0,n.dy=0,n}return O(e,t),e.prototype.registerState=function(t){this.states.push(t)},e.prototype.handleInput=function(t,e){var n=this;this.states.forEach((function(i){return i.handleInput(t,n.id,e)}))},e.prototype.update=function(){var t=this;this.states.forEach((function(e){return e.update(t)}))},e}(g),S=function(){function t(t,e){this.state=t,this.stateHandlers=e}return t.prototype.setState=function(t){this.state=t},t.prototype.handleInput=function(t,e,n){var i=this;this.stateHandlers[this.state].handleInput(t,e,n,(function(t){return i.setState(t)}))},t.prototype.update=function(t){this.stateHandlers[this.state].update(t)},t}(),T=function(t){return function(e){return e.some((function(e){return e.includes(t)&&e.includes("SPRITE_COLLISION")||e.includes("SPRITE_STATIC_OBJECT_COLLISION")}))}},k=(r="ArrowLeft",o="ArrowRight",function(t){return t.indexOf(o)>t.indexOf(r)}),_=function(t,e){return function(n){return n.indexOf(t)>n.indexOf(e)}}("ArrowLeft","ArrowRight"),P=(s="ArrowUp",u="ArrowDown",function(t){return t.indexOf(u)>t.indexOf(s)}),N=function(t,e){return function(n){return n.indexOf(t)>n.indexOf(e)}}("ArrowUp","ArrowDown"),A=new S("STATIONARY",{STATIONARY:{handleInput:function(t,e,n,i){"keyboard"===t&&(P(n)?i("MOVING_DOWN"):N(n)&&i("MOVING_UP"))},update:function(t){}},MOVING_UP:{handleInput:function(t,e,n,i){if("keyboard"===t){if(N(n))return;P(n)?i("MOVING_DOWN"):i("STATIONARY")}},update:function(t){t.dimensions.y-=2}},MOVING_DOWN:{handleInput:function(t,e,n,i){if("keyboard"===t){if(P(n))return;N(n)?i("MOVING_UP"):i("STATIONARY")}},update:function(t){t.dimensions.y+=2}}}),j=new S("STATIONARY",{STATIONARY:{handleInput:function(t,e,n,i){"keyboard"===t&&(k(n)?i("MOVING_RIGHT"):_(n)&&i("MOVING_LEFT"))},update:function(t){}},MOVING_LEFT:{handleInput:function(t,e,n,i){if("keyboard"===t){if(_(n))return;k(n)?i("MOVING_RIGHT"):i("STATIONARY")}},update:function(t){t.dimensions.x-=2}},MOVING_RIGHT:{handleInput:function(t,e,n,i){if("keyboard"===t){if(k(n))return;_(n)?i("MOVING_LEFT"):i("STATIONARY")}},update:function(t){t.dimensions.x+=2}}}),E=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((i=i.apply(t,e||[])).next())}))},M=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},L=new m({canvasId:"game-canvas",universe:{width:900,height:600},viewport:{x:0,y:0,width:900,height:600},scene:{preload:function(t){var e=t.loader;return E(this,void 0,void 0,(function(){return M(this,(function(t){switch(t.label){case 0:return[4,e.load("images/wifi.jpg")];case 1:return t.sent(),[2]}}))}))},create:function(t){var e=t.physics,n=(t.events,new I({x:200,y:200,w:25,h:25})),i=new I({x:300,y:200,w:25,h:25}),r=new I({x:400,y:200,w:25,h:25}),o=new g({x:0,y:0,w:900,h:1}),s=new g({x:899,y:0,w:1,h:600}),u=new g({x:0,y:599,w:900,h:1}),a=new g({x:0,y:0,w:1,h:600});n.registerState(j),n.registerState(A),n.registerState(new S("NOT",{NOT:{handleInput:function(t,e,n,i){"messages"===t&&T(e)(n)&&i("COLLIDED")},update:function(t){t.fillStyle="green"}},COLLIDED:{handleInput:function(t,e,n,i){"messages"!==t||T(e)(n)||i("NOT")},update:function(t){t.fillStyle="red"}}})),n.fillStyle="green",i.fillStyle="green",r.fillStyle="green",e.addStaticObject(o),e.addStaticObject(s),e.addStaticObject(u),e.addStaticObject(a),e.addSprite(n),e.addSprite(i),e.addSprite(r)},update:function(t){var e=t.brush,n=(t.loader,t.messages),i=t.viewport,r=t.physics,o=(t.events,t.pressedKeys);e.clearRect(i.x,i.y,i.width,i.height),r.update(n,o),r.staticObjects.forEach((function(t){var n=t.dimensions;e.rect(n.x,n.y,n.w,n.h).fill("gray")})),r.sprites.forEach((function(t){var n=t.dimensions,i=t.fillStyle;e.rect(n.x,n.y,n.w,n.h).fill(i)}))}}}),R=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};(function(t,e,n,i){new(n||(n=Promise))((function(r,o){function s(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((i=i.apply(t,e||[])).next())}))})(void 0,void 0,void 0,(function(){return R(this,(function(t){switch(t.label){case 0:return[4,L.init()];case 1:return t.sent(),L.play(),[2]}}))}))}]);